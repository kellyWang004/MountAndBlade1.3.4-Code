using System.Collections.Generic;
using Helpers;
using TaleWorlds.Core;
using TaleWorlds.Localization;
using TaleWorlds.ObjectSystem;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries;

public class CharacterBecameFugitiveLogEntry : LogEntry, IEncyclopediaLog
{
	[SaveableField(90)]
	public readonly Hero Hero;

	internal static void AutoGeneratedStaticCollectObjectsCharacterBecameFugitiveLogEntry(object o, List<object> collectedObjects)
	{
		((CharacterBecameFugitiveLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
	}

	protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
	{
		base.AutoGeneratedInstanceCollectObjects(collectedObjects);
		collectedObjects.Add(Hero);
	}

	internal static object AutoGeneratedGetMemberValueHero(object o)
	{
		return ((CharacterBecameFugitiveLogEntry)o).Hero;
	}

	public CharacterBecameFugitiveLogEntry(Hero hero)
	{
		Hero = hero;
	}

	public override string ToString()
	{
		return GetEncyclopediaText().ToString();
	}

	public bool IsVisibleInEncyclopediaPageOf<T>(T obj) where T : MBObjectBase
	{
		return (object)obj == Hero;
	}

	public TextObject GetEncyclopediaText()
	{
		TextObject textObject = GameTexts.FindText("str_fugitive_news");
		StringHelpers.SetCharacterProperties("HERO", Hero.CharacterObject, textObject);
		return textObject;
	}

	public override bool IsValid()
	{
		if (Hero != null)
		{
			if (Hero.IsRebel)
			{
				return Hero.IsAlive;
			}
			return true;
		}
		return false;
	}
}
