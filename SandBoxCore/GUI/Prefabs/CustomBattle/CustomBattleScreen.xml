<Prefab>
  <Constants>
    <Constant Name="Search.Popup.MarginLeft" Value="221" />
    <Constant Name="Search.Popup.MarginRight" Value="221" />
    <Constant Name="Search.Popup.MarginBottom" Value="83" />
    <Constant Name="Search.Popup.MarginTop" Value="33" />
    <!--Sycned with other Encyclopedia Pages-->

    <Constant Name="SearchResult.Popup.MarginRight" Additive="-5" Value="!Search.Popup.MarginRight" />

    <Constant Name="Search.TextField.Height" Value="40" />
    <Constant Name="Search.TextField.MarginTop" Additive="!Search.TextField.Height" Value="!Search.Popup.MarginTop" />

    <Constant Name="Encyclopedia.Frame.Width" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Width" />
    <Constant Name="Encyclopedia.Frame.Height" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Height" />

    <Constant Name="DoneButton.Margin.Top" Additive="-10" Value="!Encyclopedia.Frame.Height" />

    <Constant Name="Popup.CloseButton.Width" BrushLayer="Default" BrushName="Popup.CloseButton" BrushValueType="Width" />
    <Constant Name="Popup.CloseButton.Height" BrushLayer="Default" BrushName="Popup.CloseButton" BrushValueType="Height" />

    <Constant Name="InnerPanel.LeftRight.Padding" Value="80" />

    <Constant Name="SpectateButton.Width" BrushLayer="Default" BrushName="WideButton.Flat" BrushValueType="Width" />
    <Constant Name="SpectateButton.Height" BrushLayer="Default" BrushName="WideButton.Flat" BrushValueType="Height" />

    <Constant Name="RandomizeButton.Width" BrushLayer="Default" BrushName="CustomBattle.Random.Button" BrushValueType="Width" />
    <Constant Name="RandomizeButton.Height" BrushLayer="Default" BrushName="CustomBattle.Random.Button" BrushValueType="Height" />

    <Constant Name="CloseButton.Width" BrushLayer="Default" BrushName="CustomBattle.Leave.Button" BrushValueType="Width" />
    <Constant Name="CloseButton.Height" BrushLayer="Default" BrushName="CustomBattle.Leave.Button" BrushValueType="Height" />

    <Constant Name="RefreshButton.Width" BrushLayer="Default" BrushName="RefreshButton.Flat" BrushValueType="Width" MultiplyResult="0.6" />
    <Constant Name="RefreshButton.Height" BrushLayer="Default" BrushName="RefreshButton.Flat" BrushValueType="Height" MultiplyResult="0.6" />

    <Constant Name="SiegeMachines.HorizontalPadding" Value="3"/>
    <Constant Name="SiegeMachines.VerticalPadding" Value="5"/>
    <Constant Name="SiegeMachines.MarginRight" Value="65"/>

  </Constants>
  <Variables>
  </Variables>
  <VisualDefinitions>
    <VisualDefinition Name="LeftMenu" EaseType="EaseOut" EaseFunction="Quint" TransitionDuration="0.45">
      <VisualState PositionXOffset="0" State="Default" />
    </VisualDefinition>
    <VisualDefinition Name="RightMenu" EaseType="EaseOut" EaseFunction="Quint" TransitionDuration="0.45">
      <VisualState PositionXOffset="0" State="Default" />
    </VisualDefinition>
    <VisualDefinition Name="CenterMenu" EaseType="EaseOut" EaseFunction="Quint" TransitionDuration="0.45">
      <VisualState PositionYOffset="0" State="Default" />
    </VisualDefinition>
  </VisualDefinitions>
  <Window>
    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent">
      <Children>
        <Standard.Background />
        <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" StackLayout.LayoutMethod="HorizontalLeftToRight">
          <Children>

            <!--Left Side Panel-->
            <ArmyComposition DataSource="{PlayerSide}" VisualDefinition="LeftMenu" HorizontalAlignment="Left" PositionXOffset="-550" Parameter.TitleText="@TitleText" />

            <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent">
              <Children>

                <!--Center Panel-->
                <Widget VisualDefinition="CenterMenu" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" VerticalAlignment="Top" PositionYOffset="-505" Sprite="flat_panel_9" ExtendLeft="53" ExtendRight="52" AlphaFactor="0.5">
                  <Children>

                    <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="25">
                      <Children>
                        <!--Padding-->
                        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!RefreshButton.Width" SuggestedHeight="!RefreshButton.Height" MarginRight="5" IsVisible="@CanSwitchMode"/>

                        <!--Title-->
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="CustomBattle.Title.Text" Text="@TitleText"/>

                        <!--Switch to Next Custom Game Button-->
                        <NavigationScopeTargeter ScopeID="SwitchButtonScope" ScopeParent="..\SwitchButton" />
                        <ButtonWidget Id="SwitchButton" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!RefreshButton.Width" SuggestedHeight="!RefreshButton.Height" MarginLeft="5" VerticalAlignment="Center" Brush="RefreshButton.Flat" Command.Click="ExecuteSwitchToNextCustomBattle" IsVisible="@CanSwitchMode" DoNotPassEventsToChildren="true" UpdateChildrenStates="true" GamepadNavigationIndex="0">
                          <Children>
                            <HintWidget DataSource="{SwitchHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsEnabled="false" />
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="Fixed" SuggestedHeight="15" VerticalAlignment="Top" PositionYOffset="-13" HorizontalAlignment="Center" Brush="MPLobby.Matchmaking.CircleButtonText" Text="@SwitchButtonText" />
                          </Children>
                        </ButtonWidget>
                      </Children>
                    </ListPanel>
                    
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="650" SuggestedHeight="7" HorizontalAlignment="Center" VerticalAlignment="Top" PositionYOffset="75" Sprite="SPGeneral\TownManagement\title_divider" />

										<NavigationScopeTargeter ScopeID="CenterSelectionsScope" ScopeParent="..\CenterSelections" ScopeMovements="Vertical" />
                    <ListPanel Id="CenterSelections" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginTop="100" StackLayout.LayoutMethod="VerticalBottomToTop">
                      <Children>

                        <!--_____Map Selection_________-->
                        <Widget DataSource="{GameTypeSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@GameTypeText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{GameTypeSelection}" GamepadNavigationIndex="0" />
                          </Children>
                        </Widget>

                        <Widget DataSource="{GameTypeSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@PlayerTypeText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{PlayerTypeSelection}" GamepadNavigationIndex="1" />
                          </Children>
                        </Widget>

                        <Widget DataSource="{GameTypeSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@PlayerSideText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{PlayerSideSelection}" GamepadNavigationIndex="2"/>
                          </Children>
                        </Widget>

                        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="12" MarginTop="20" Sprite="StdAssets\subpage_divider" />

                        <RichTextWidget DataSource="{MapSelectionGroup}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="CustomBattle.Character.Title.Text" Text="@TitleText" />

                        <!--<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="310" SuggestedHeight="175" HorizontalAlignment="Center" MarginTop="40" Sprite="BlankWhiteSquare_9" Color="#FF00FF33" />-->
                        
                        <!--Map Selection-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@MapText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{MapSelection}" GamepadNavigationIndex="3" />
                          </Children>
                        </Widget>
                        
                        <!--Season Selection-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@SeasonText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{SeasonSelection}" GamepadNavigationIndex="4" />
                          </Children>
                        </Widget>

                        <!--Time Of Day Selection-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@TimeOfDayText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{TimeOfDaySelection}" GamepadNavigationIndex="5"/>
                          </Children>
                        </Widget>

                        <!--Scene Level Selection-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15" IsVisible="@IsCurrentMapSiege">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@SceneLevelText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{SceneLevelSelection}" GamepadNavigationIndex="6" />
                          </Children>
                        </Widget>

                        <!--Wall Hitpoints-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15" IsVisible="@IsCurrentMapSiege">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@WallHitpointsText" />
                            <Standard.DropdownWithHorizontalControl HorizontalAlignment="Right" Parameter.SelectorDataSource="{WallHitpointSelection}" GamepadNavigationIndex="7" />
                          </Children>
                        </Widget>

                        <!--Attacker Siege Machines-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="25" IsVisible="@IsCurrentMapSiege">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@AttackerSiegeMachinesText" />
                            <!--<Standard.DropdownWithHorizontalControl DataSource="{..\AttackerSiegePrioritySelection}" HorizontalAlignment="Right" />-->

                            <!--Attacker Machines-->
                            <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop" MarginRight="!SiegeMachines.MarginRight">
                              <Children>

                                <!--Attacker Melee Machines-->
                                <NavigationScopeTargeter ScopeID="AttackerMeleeMachinesSelectionScope" ScopeParent="..\AttackerMeleeMachines" ScopeMovements="Horizontal" />
                                <NavigatableListPanel Id="AttackerMeleeMachines" DataSource="{..\AttackerMeleeMachines}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center">
                                  <ItemTemplate>
                                    <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="50" SuggestedHeight="50" MarginLeft="!SiegeMachines.HorizontalPadding" MarginRight="!SiegeMachines.HorizontalPadding" Brush="CustomBattle.Machine.Slot" Command.Click="OnSelection" Command.AlternateClick="OnResetSelection">
                                      <Children>
                                        <OrderSiegeMachineItemButtonWidget Id="MachineIconWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" HorizontalAlignment="Center" VerticalAlignment="Center" MachineIconWidget="..\MachineIconWidget" Brush="CustomBattle.Siege.MachineIcon" MachineClass="@MachineID"/>
                                      </Children>
                                    </ButtonWidget>
                                  </ItemTemplate>
                                </NavigatableListPanel>

                                <!--Attacker Ranged Machines-->
                                <NavigationScopeTargeter ScopeID="AttackerRangedMachinesSelectionScope" ScopeParent="..\AttackerRangedMachines" ScopeMovements="Horizontal" />
                                <NavigatableListPanel Id="AttackerRangedMachines" DataSource="{..\AttackerRangedMachines}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="!SiegeMachines.VerticalPadding">
                                  <ItemTemplate>
                                    <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="50" SuggestedHeight="50" MarginLeft="!SiegeMachines.HorizontalPadding" MarginRight="!SiegeMachines.HorizontalPadding" Brush="CustomBattle.Machine.Slot" Command.Click="OnSelection" Command.AlternateClick="OnResetSelection">
                                      <Children>
                                        <OrderSiegeMachineItemButtonWidget Id="MachineIconWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" HorizontalAlignment="Center" VerticalAlignment="Center" MachineIconWidget="..\MachineIconWidget" Brush="CustomBattle.Siege.MachineIcon" MachineClass="@MachineID" />
                                      </Children>
                                    </ButtonWidget>
                                  </ItemTemplate>
                                </NavigatableListPanel>

                                <!--<ButtonWidget DataSource="{..}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="RandomButtonBrush" Command.Click="ExecuteRandomizeAttackerSiegeEngines" />-->

                              </Children>
                            </ListPanel>

                          </Children>
                        </Widget>

                        <!--Defender Siege Machines-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="25" IsVisible="@IsCurrentMapSiege">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@DefenderSiegeMachinesText" />
                            <!--<Standard.DropdownWithHorizontalControl DataSource="{..\DefenderSiegePrioritySelection}" HorizontalAlignment="Right" />-->

                            <!--Defender Machines-->
                            <Widget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Center" MarginRight="!SiegeMachines.MarginRight" >
                              <Children>
                                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                                  <Children>
                                    <NavigationScopeTargeter ScopeID="DefenderMachinesSelectionScope" ScopeParent="..\DefenderMachines" ScopeMovements="Horizontal" />
                                    <NavigatableListPanel Id="DefenderMachines" DataSource="{..\DefenderMachines}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren">
                                      <ItemTemplate>
                                        <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="50" SuggestedHeight="50" MarginLeft="!SiegeMachines.HorizontalPadding" MarginRight="!SiegeMachines.HorizontalPadding" Brush="CustomBattle.Machine.Slot" Command.Click="OnSelection" Command.AlternateClick="OnResetSelection">
                                          <Children>
                                            <OrderSiegeMachineItemButtonWidget Id="MachineIconWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" HorizontalAlignment="Center" VerticalAlignment="Center" MachineIconWidget="..\MachineIconWidget" Brush="CustomBattle.Siege.MachineIcon" MachineClass="@MachineID"/>
                                          </Children>
                                        </ButtonWidget>
                                      </ItemTemplate>
                                    </NavigatableListPanel>

                                    <!--<ButtonWidget DataSource="{..}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="RandomButtonBrush" Command.Click="ExecuteRandomizeDefenderSiegeEngines" />-->
                                  </Children>
                                </ListPanel>
                              </Children>
                            </Widget>

                          </Children>
                        </Widget>

                        <!--Sallyout-->
                        <Widget DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" SuggestedWidth="590" HorizontalAlignment="Center" HeightSizePolicy="CoverChildren" MarginLeft="!InnerPanel.LeftRight.Padding" MarginRight="!InnerPanel.LeftRight.Padding" MarginTop="15" IsVisible="false">
                          <Children>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" Text="@SallyoutText" />

                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="380" HorizontalAlignment="Right">
                              <Children>

                                <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="SPOptions.Checkbox.Empty.Button" ButtonType="Toggle" IsSelected="@IsSallyOutSelected" ToggleIndicator="ToggleIndicator" UpdateChildrenStates="true" GamepadNavigationIndex="3001">
                                  <Children>
                                    <ImageWidget Id="ToggleIndicator" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="SPOptions.Checkbox.Full.Button" />
                                  </Children>
                                </ButtonWidget>

                              </Children>
                            </Widget>

                          </Children>
                        </Widget>

                      </Children>
                    </ListPanel>

                    <!--Search Text Bar-->
                    <!--<EncyclopediaSearchBarBrushWidget DataSource="{MapSelectionGroup}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="303" SuggestedHeight="43" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="345" Brush="SPOptions.Dropdown.Center" MinCharAmountToShowResults="0" SearchInputWidget="SearchInputWidget" SearchResultPanel="..\SearchResultListScrollablePanel">
                      <Children>
                        <EditableTextWidget Id="SearchInputWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="298" SuggestedHeight="43" MarginLeft="5" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="CustomBattle.Search.TextBox" Text="@SearchText" DefaultSearchText="@SearchDefaultText" />
                        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="25" SuggestedHeight="24" HorizontalAlignment="Right" VerticalAlignment="Center" MarginRight="10" Sprite="Encyclopedia\icon_search" IsDisabled="true" />
                      </Children>
                    </EncyclopediaSearchBarBrushWidget>

                    <ScrollbarWidget Id="SearchResultListScrollbar" DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="20" SuggestedHeight="110" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="75" AlignmentAxis="Vertical" Handle="SearchResultListScrollbarHandle" IsEnabled="false" IsVisible="false" MaxValue="100" MinValue="0">
                      <Children>
                        <Widget Id="SearchResultListScrollbarHandle" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="50" HorizontalAlignment="Center" IsVisible="false" />
                      </Children>
                    </ScrollbarWidget>

                    <ScrollablePanel Id="SearchResultListScrollablePanel" DataSource="{MapSelectionGroup}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="330" SuggestedHeight="380" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="380" Sprite="SPGeneral\SPOptions\standart_dropdown_extension" AutoHideScrollBarHandle="true" AutoHideScrollBars="true" ClipRect="SearchResultListRect" InnerPanel="SearchResultListRect\SearchResultList" MouseScrollAxis="Vertical" VerticalScrollbar="..\SearchResultListScrollbar">
                      <Children>

                        <Widget Id="SearchResultListRect" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="17" MarginRight="10" MarginTop="8" MarginBottom="17" ClipContents="true">
                          <Children>

                            <ListPanel Id="SearchResultList" DataSource="{MapSearchResults}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Top" MarginTop="5" StackLayout.LayoutMethod="VerticalTopToBottom">
                              <ItemTemplate>

                                <ButtonWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="25" MarginBottom="5" Brush="Standard.DropdownItem" Command.Click="ExecuteSelection">
                                  <Children>
                                    <RichTextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="CustomBattleSearchResult.Text" Brush.Font="FiraSansExtraCondensed-Regular" Brush.FontSize="22" IsDisabled="true" Text="@NameText" />
                                  </Children>
                                </ButtonWidget>

                              </ItemTemplate>
                            </ListPanel>

                          </Children>
                        </Widget>

                      </Children>
                    </ScrollablePanel>-->

										<NavigationScopeTargeter ScopeID="CenterControlsScope" ScopeParent="..\CenterControls" ScopeMovements="Horizontal" />
										<ListPanel Id="CenterControls" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginBottom="10" VerticalAlignment="Bottom">
                      <Children>

                        <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!RandomizeButton.Width" SuggestedHeight="!RandomizeButton.Height" HorizontalAlignment="Left" VerticalAlignment="Bottom" MarginRight="40"  Brush="CustomBattle.Random.Button" Command.Click="ExecuteRandomize" UpdateChildrenStates="true" GamepadNavigationIndex="0">
                          <Children>
                            <InputKeyVisualWidget DataSource="{RandomizeInputKey}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="60" SuggestedHeight="60" HorizontalAlignment="Left" VerticalAlignment="Center" PositionXOffset="-45" KeyID="@KeyID" IsVisible="@IsVisible"/>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="Fixed" SuggestedHeight="35" VerticalAlignment="Top" PositionYOffset="-30" HorizontalAlignment="Center" Brush="MPLobby.Matchmaking.CircleButtonText" Text="@RandomizeButtonText" />
                          </Children>
                        </ButtonWidget>

                        <ButtonWidget DoNotPassEventsToChildren="true" SuggestedWidth="!SpectateButton.Width" SuggestedHeight="!SpectateButton.Height" HorizontalAlignment="Center" VerticalAlignment="Bottom" Brush="WideButton.Flat" Command.Click="ExecuteStart" UpdateChildrenStates="true" GamepadNavigationIndex="1">
                          <Children>
                            <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" UpdateChildrenStates="true">
                              <Children>
                                <InputKeyVisualWidget DataSource="{StartInputKey}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="60" SuggestedHeight="60" HorizontalAlignment="Center" VerticalAlignment="Center" KeyID="@KeyID" IsVisible="@IsVisible"/>
                                <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" MarginTop="10" MarginBottom="10" HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="300" Brush="MPTeamSelection.SpectateButton.Text" Text="@StartButtonText" />
                              </Children>
                            </ListPanel>
                          </Children>
                        </ButtonWidget>

                        <ButtonWidget DoNotPassEventsToChildren="true" Command.Click="ExecuteBack" SuggestedWidth = "!CloseButton.Width" SuggestedHeight = "!CloseButton.Height" HorizontalAlignment = "Right" VerticalAlignment = "Bottom" MarginLeft="40" Brush="CustomBattle.Leave.Button" UpdateChildrenStates="true" GamepadNavigationIndex="2">
                          <Children>
                            <InputKeyVisualWidget DataSource="{CancelInputKey}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="60" SuggestedHeight="60" HorizontalAlignment="Left" VerticalAlignment="Center" PositionXOffset="-45" KeyID="@KeyID" IsVisible="@IsVisible"/>
                            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="Fixed" SuggestedHeight="35" VerticalAlignment="Top" PositionYOffset="-30" HorizontalAlignment="Center" Brush="MPLobby.Matchmaking.CircleButtonText" Text="@BackButtonText" />
                          </Children>
                        </ButtonWidget>

                      </Children>
                    </ListPanel>

                  </Children>
                </Widget>

              </Children>
            </Widget>

            <!--_____Right Side Panel_______-->
            <ArmyComposition DataSource="{EnemySide}" VisualDefinition="RightMenu" HorizontalAlignment="Right" PositionXOffset="550" Parameter.TitleText="@TitleText" />

          </Children>
        </ListPanel>

        <TroopTypeSelectionPopUp Parameter.PopUpDataSource="{TroopTypeSelectionPopUp}"/>

      </Children>
    </Widget>
  </Window>
</Prefab>