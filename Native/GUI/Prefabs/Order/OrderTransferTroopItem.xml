<Prefab>
	<Constants>
		
		<Constant Name="Troop.Icon.Width" BrushName="Order.Troop.Icon" BrushLayer="Default" BrushValueType="Width" MultiplyResult="0.5"/>
		<Constant Name="Troop.Icon.Height" BrushName="Order.Troop.Icon" BrushLayer="Default" BrushValueType="Height" MultiplyResult="0.5"/>
    
    <!-- Filter Brush Constants -->
    <Constant Name="FilterUnsetBrush"           Value="OrderOfBattle.Filter.Unset" />
    <Constant Name="SpearBrush"                 Value="OrderOfBattle.Filter.Spear" />
    <Constant Name="ShieldBrush"                Value="OrderOfBattle.Filter.Shield" />
    <Constant Name="ThrownBrush"                Value="OrderOfBattle.Filter.Thrown" />
    <Constant Name="HeavyBrush"                 Value="OrderOfBattle.Filter.Heavy" />  
    <Constant Name="HighTierBrush"              Value="OrderOfBattle.Filter.HighTier" />  
    <Constant Name="LowTierBrush"               Value="OrderOfBattle.Filter.LowTier" />  
	</Constants>
	<Window>
    <OrderTroopItemBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="109" SuggestedHeight="163" FormationClass="@OrderOfBattleFormationClass" FormationIconWidget="Icon">
			<Children>

        <!--Formation Name-->
        <BrushWidget DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" UpdateChildrenStates="true" HeightSizePolicy="Fixed" WidthSizePolicy="Fixed" SuggestedWidth="35" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Bottom" PositionYOffset="20" Brush="OrderOfBattle.FormationTypeSelection.Dropdown">
          <Children>
            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" HorizontalAlignment="Center" Brush.FontSize="20" Text="@FormationName"/>
          </Children>
        </BrushWidget>

				<!-- Troop Type Icons and Troop Counts -->
        <ListPanel DataSource="{ActiveFormationClasses}" Id="PrimaryColorGrid" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="50" MarginLeft="10" MarginRight="10">
          <ItemTemplate>

            <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop">
              <Children>
                <OrderFormationClassVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Troop.Icon.Width" SuggestedHeight="!Troop.Icon.Height" HorizontalAlignment="Center" FormationClassValue="@FormationClassValue" Brush="Order.Troop.Icon" />
                <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" PositionYOffset="-5" Brush="Order.Troop.CountText" IntText="@TroopCount" />
              </Children>
            </ListPanel>

          </ItemTemplate>
        </ListPanel>

        <!-- Troop Count -->
        <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginLeft="15" MarginTop="10" StackLayout.LayoutMethod="HorizontalLeftToRight">
          <Children>
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" VerticalAlignment="Center" Sprite="General\Icons\Morale@2x"/>
            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginLeft="1" MarginTop="8" VerticalAlignment="Center" Brush="Order.Troop.CountText" Brush.FontSize="20" IntText="@Morale" IsVisible="@HaveTroops" />
          </Children>
        </ListPanel>

        <!-- Ammo Percentage -->
        <SliderWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="3" SuggestedWidth="65" HorizontalAlignment="Center" VerticalAlignment="Bottom" MarginBottom="13" MarginLeft="3" DoNotUpdateHandleSize="true" Filler="Filler" Handle="SliderHandle" MaxValueFloat="1" MinValueFloat="0" ValueFloat="@AmmoPercentage" AlignmentAxis="Horizontal" IsVisible="@IsAmmoAvailable">
          <Children>
            <Widget Id="Filler" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="3" SuggestedWidth="100" VerticalAlignment="Bottom" Sprite="BlankWhiteSquare_9" />
            <Widget Id="SliderHandle" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="2" SuggestedHeight="2" HorizontalAlignment="Left" VerticalAlignment="Center" IsVisible="false" />
          </Children>
        </SliderWidget>

        <!-- Selection Frame -->
        <Widget Id="SelectionFrame" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="order_formation_selector_9" Color="#00FF00FF" IsVisible="false" />

        <!-- Captain Visual -->
        <ImageIdentifierWidget DoNotAcceptEvents="true" DataSource="{CaptainImageIdentifier}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="35" SuggestedHeight="25" HorizontalAlignment="Center" VerticalAlignment="Top" PositionYOffset="-22" AdditionalArgs="@AdditionalArgs" ImageId="@Id" TextureProviderName="@TextureProviderName" />

        <!-- Filters -->
        <ListPanel DataSource="{ActiveFilters}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Bottom" MarginBottom="20">
          <ItemTemplate>
            <OrderOfBattleFormationFilterVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="15" SuggestedHeight="15" FormationFilter="@FilterTypeValue" UnsetBrush="!FilterUnsetBrush" SpearBrush="!SpearBrush" ShieldBrush="!ShieldBrush" ThrownBrush="!ThrownBrush" HeavyBrush="!HeavyBrush" HighTierBrush="!HighTierBrush" LowTierBrush="!LowTierBrush" />
          </ItemTemplate>
        </ListPanel>

        <!--<TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Bottom" PositionYOffset="15" Brush="Order.Transferred.Troop.Text" Brush.FontSize="20" Brush.FontColor="#FF00FFFF" Text="+15" />-->

      </Children>
		</OrderTroopItemBrushWidget>
	</Window>
</Prefab>