<Prefab>
  <Parameters>
    <Parameter Name="TitleText" DefaultValue="Player" />
    <Parameter Name="FactionText" DefaultValue="Player Faction" />
  </Parameters>
  <Window>
    <!--_______Side Panel_______-->
    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="585" HorizontalAlignment="Left">
      <Children>

        <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="30" Brush="CustomBattle.Character.Title.Text" Text="@Name" />

        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="265" MarginTop="140" ClipContents="true">
          <Children>

            <!--Selected Character Tableau-->
            <CharacterTableauWidget DataSource="{CurrentSelectedCharacter}" WidthSizePolicy="StretchToParent" HeightSizePolicy ="Fixed" SuggestedWidth="400" SuggestedHeight="400" BodyProperties="@BodyProperties" IsFemale="@IsFemale" EquipmentCode="@EquipmentCode" CharStringId="@CharStringId" StanceIndex="@StanceIndex" BannerCodeText="@BannerCodeText"  PositionYOffset="-30" ArmorColor1="@ArmorColor1" ArmorColor2="@ArmorColor2" Race="@Race" IsBannerShownInBackground="true"/>

            <ListPanel DataSource="{ArmorsList}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" PositionYOffset="5" MarginLeft="25" StackLayout.LayoutMethod="VerticalBottomToTop">
              <ItemTemplate>
                <EquipmentTypeVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="35" SuggestedHeight="35" HorizontalAlignment="Left" MarginLeft="5" MarginBottom="5" Brush="EquipmentType.Image" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsVisible="@HasItem" Type="@Type" />
              </ItemTemplate>
            </ListPanel>

            <ListPanel DataSource="{WeaponsList}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" PositionYOffset="5"  MarginRight="25" StackLayout.LayoutMethod="VerticalBottomToTop">
              <ItemTemplate>
                <EquipmentTypeVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="35" SuggestedHeight="35" HorizontalAlignment="Right" MarginRight="5" MarginBottom="5" Brush="EquipmentType.Image" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsVisible="@HasItem" Type="@Type" />
              </ItemTemplate>
            </ListPanel>

          </Children>
        </Widget>

				<NavigationScopeTargeter ScopeID="ArmyCompositionCharacterSelectionScope" ScopeParent="..\CharacterSelectionDropdown" />
        <Standard.DropdownWithHorizontalControl Id="CharacterSelectionDropdown" HorizontalAlignment="Center" Parameter.SelectorDataSource="{CharacterSelectionGroup}" MarginTop="85" GamepadNavigationIndex="0"/>

        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="12" Sprite="StdAssets\subpage_divider" MarginTop="400"/>

        <!--_____Faction Selection_______-->
        <RichTextWidget DataSource="{FactionSelectionGroup}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" MarginTop="420" Brush="CustomBattle.Character.Title.Text" Text="@SelectedFactionName" />

				<NavigationScopeTargeter ScopeID="ArmyCompositionFactionSelectionScope" ScopeParent="..\FactionSelectionList" ScopeMovements="Horizontal" />
        <NavigatableListPanel Id="FactionSelectionList" DataSource="{FactionSelectionGroup\Factions}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="470">
          <ItemTemplate>
            <MultiplayerLobbyClassFilterFactionItemButtonWidget ButtonType="Radio" IsEnabled="true" IsSelected="@IsSelected" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="52" SuggestedHeight="52" MarginLeft="9" MarginRight="9" Culture="@CultureCode">
              <Children>
                <HintWidget DataSource="{Hint}" DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
              </Children>
            </MultiplayerLobbyClassFilterFactionItemButtonWidget>
          </ItemTemplate>
        </NavigatableListPanel>

        <!-- Ship Selection Area -->
        <NavigationScopeTargeter ScopeID="ShipButtonsScope" ScopeParent="..\ShipButtonsGrid" ScopeMovements="Horizontal" AlternateScopeMovements="Vertical" AlternateMovementStepSize="4" />
        <NavigatableGridWidget Id="ShipButtonsGrid" DataSource="{ShipSelectionGroup\ShipSelectionItems}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginTop="545" UseDynamicCellHeight="true" ColumnCount="4" LayoutImp="GridLayout">
          <ItemTemplate>
            <ButtonWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="80" MarginLeft="15" MarginRight="15" MarginBottom="30" UpdateChildrenStates="true" Command.Click="ExecuteOpenPopUp" Command.HoverBegin="ExecuteHoverBegin" Command.HoverEnd="ExecuteHoverEnd">
              <Children>
                <BrushWidget DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="Naval.CustomBattle.Ship.Button.PlusIcon" IsHidden="@HasSelectedItem"/>

                <HintWidget DataSource="{SelectedItem\Tooltip}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />
                
                <Widget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@HasSelectedItem" UpdateChildrenStates="true">
                  <Children>
                    <Widget DoNotAcceptEvents="true" DataSource="{SelectedItem}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" UpdateChildrenStates="true">
                      <Children>
                        <ShipThumbnailWidget DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="2" MarginTop="2" MarginRight="2" MarginBottom="2" SpriteBrush="Naval.ShipThumbnails" StyleBrush="Naval.CustomBattle.Ship.Image" PrefabId="@PrefabId"/>
                        
                        <TextWidget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="20" VerticalAlignment="Top" MarginTop="80" Brush="CustomBattle.Character.Title.Text" Brush.FontSize="16" Text="@Name"/>
                        
                        <!--Upgrades-->
                        <Widget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Bottom" Sprite="StdAssets\Popup\canvas_gradient" ExtendTop="12">
                          <Children>

                            <ButtonWidget Id="CycleTierButton" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Right" VerticalAlignment="Bottom" Command.Click="ExecuteCycleUpgradeTier" UpdateChildrenStates="true">
                              <Children>
                                <BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="3" MarginRight="3" MarginTop="3" MarginBottom="3" Brush="Naval.CustomBattle.Ship.Button.CycleTierButton"/>
                                <Widget DataSource="{..}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="-15" IsVisible="@IsHovered">
                                  <Children>
                                    <InputKeyVisualWidget DataSource="{CycleTierInputKey}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="35" SuggestedHeight="35" KeyID="@KeyID" IsVisible="@IsVisible"/>
                                  </Children>
                                </Widget>
                                <HintWidget DataSource="{CycleTierHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />
                              </Children>
                            </ButtonWidget>
                            
                            <ListPanel DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Bottom" MarginBottom="6">
                              <Children>
                                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="8" SuggestedHeight="8" MarginLeft="3" MarginRight="3" VerticalAlignment="Center" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" AlphaFactor="0.3">
                                  <Children>
                                    <ValueBasedVisibilityWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IndexToBeVisible="1" WatchType="BiggerThanEqual" IndexToWatch="@Tier" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" />
                                  </Children>
                                </Widget>
                                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="8" SuggestedHeight="8" MarginLeft="3" MarginRight="3" VerticalAlignment="Center" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" AlphaFactor="0.3">
                                  <Children>
                                    <ValueBasedVisibilityWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IndexToBeVisible="2" WatchType="BiggerThanEqual" IndexToWatch="@Tier" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" />
                                  </Children>
                                </Widget>
                                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="8" SuggestedHeight="8" MarginLeft="3" MarginRight="3" VerticalAlignment="Center" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" AlphaFactor="0.3">
                                  <Children>
                                    <ValueBasedVisibilityWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IndexToBeVisible="3" WatchType="BiggerThanEqual" IndexToWatch="@Tier" Sprite="BlankWhiteCircle" Color="#F4E1C4FF" />
                                  </Children>
                                </Widget>
                              </Children>
                            </ListPanel>
                            
                          </Children>
                        </Widget>
                      </Children>
                    </Widget>
                  </Children>
                </Widget>

                <BrushWidget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Naval.CustomBattle.Ship.Button"/>

                <Widget DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Right" VerticalAlignment="Top" PositionXOffset="6" PositionYOffset="-6" IsVisible="@CanBecomeEmpty">
                  <Children>
                    <ButtonWidget Id="ClearShipButton" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="1" MarginRight="1" MarginTop="1" MarginBottom="1" Command.Click="ExecuteClearShip" UpdateChildrenStates="true">
                      <Children>
                        <BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Naval.CustomBattle.Ship.Button.ClearShipButton"/>
                        <HintWidget DataSource="{ClearShipHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />
                      </Children>
                    </ButtonWidget>
                  </Children>
                </Widget>

              </Children>
            </ButtonWidget>
          </ItemTemplate>
        </NavigatableGridWidget>

        <!--_____Army Composition_______-->
        <ListPanel DataSource="{CompositionGroup}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginTop="770" StackLayout.LayoutMethod="VerticalBottomToTop">
          <Children>
            <CompositionSlider MarginLeft="20" Parameter.SliderImage="General\compass\Infantry_Light" Parameter.CompositionDataSource="{MeleeInfantryComposition}" Parameter.ShowLock="false"/>
            <CompositionSlider MarginLeft="20" Parameter.SliderImage="General\compass\Archer_Light" Parameter.CompositionDataSource="{RangedInfantryComposition}" Parameter.ShowLock="false"/>
          </Children>
        </ListPanel>

        <!--Army Size Slider-->
				<NavigationScopeTargeter ScopeID="ArmyCompositionSizeSliderScope" ScopeParent="..\CompositionGroup" ScopeMovements="Horizontal" />
        <Widget Id="CompositionGroup" DataSource="{CompositionGroup}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" HorizontalAlignment="Center" VerticalAlignment="Bottom" SuggestedWidth="450" SuggestedHeight="38" MarginBottom="40" MarginLeft="80" >
          <Children>

            <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="338" SuggestedHeight="42" HorizontalAlignment="Left" VerticalAlignment="Center" PositionYOffset="-45" Brush="CustomBattle.Character.Title.Text" Text="@ArmySizeTitle" />

            <SliderWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="338" SuggestedHeight="42" VerticalAlignment="Center" Filler="Filler" Handle="SliderHandle" Locked="false" MaxValueInt="@MaxArmySize" MinValueInt="@MinArmySize" ValueInt="@ArmySize" IsDisabled="false" DoNotPassEventsToChildren="true" UpdateChildrenStates="true" IsDiscrete="true" DoNotUpdateHandleSize="true">
              <Children>
                <ImageWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="362" SuggestedHeight="38" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="CustomBattle.Slider.Canvas"/>
                <ImageWidget Id="Filler" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="345" SuggestedHeight="35" VerticalAlignment="Center" Brush="CustomBattle.Slider.Fill" ClipContents="true" UpdateChildrenStates="true">
                  <Children>
                    <ImageWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="345" SuggestedHeight="35" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Slider.Fill">
                      <Children>
                        <BoolBrushChangerBrushWidget TargetWidget="..\." BooleanCheck="@IsWarned" TrueBrush="Naval.CustomBattle.Slider.Fill.Warning" FalseBrush="CustomBattle.Slider.Fill"/>
                      </Children>
                    </ImageWidget>
                  </Children>
                </ImageWidget>
                <ImageWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="400" SuggestedHeight="65" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="CustomBattle.Slider.Frame"/>
                <ImageWidget Id="SliderHandle" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="14" SuggestedHeight="38" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Slider.Handle" DoNotAcceptEvents="true" GamepadNavigationIndex="0"/>
              </Children>
            </SliderWidget>

            <IntegerInputTextWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="70" SuggestedHeight="30" HorizontalAlignment="Right" VerticalAlignment="Center" Brush="CustomBattle.SliderValue.Text" IntText="@ArmySize" MaxInt="@MaxArmySize" MinInt="@MinArmySize" EnableClamp="true" ClipContents="false" IsDisabled="false" UpdateChildrenStates="true" DoNotPassEventsToChildren="true" MaxLength="4" GamepadNavigationIndex="1">
              <Children>
                <BrushWidget  WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="CustomBattle.SliderValue.Input" ClipContents="false"/>
              </Children>
            </IntegerInputTextWidget>

            <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="338" SuggestedHeight="20" HorizontalAlignment="Left" VerticalAlignment="Center" PositionYOffset="35" Brush="Naval.CustomBattle.Warning.Text" Text="@WarningText" IsVisible="@IsWarned" />

          </Children>
        </Widget>
        
      </Children>
    </Widget>
  </Window>
</Prefab>