<Prefab>
  <Constants>

    <Constant Name="Kingdom.Item.Tuple.Width" BrushLayer="Default" BrushName="Kingdom.Item.Tuple" BrushValueType="Width" />
    <Constant Name="Kingdom.Item.Tuple.Height" BrushLayer="Default" BrushName="Kingdom.Item.Tuple" BrushValueType="Height" />

    <Constant Name="Banner.Width" BrushLayer="Default" BrushName="Flat.Tuple.Banner.Small" BrushValueType="Width" />
    <Constant Name="Banner.Height" BrushLayer="Default" BrushName="Flat.Tuple.Banner.Small" BrushValueType="Height" />

    <Constant Name="Banner.Width.Scaled" MultiplyResult="0.43" Value="!Banner.Width" />
    <Constant Name="Banner.Height.Scaled" MultiplyResult="0.43" Value="!Banner.Height"/>
  </Constants>
  <Window>
    <ButtonWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Kingdom.Item.Tuple.Width" SuggestedHeight="!Kingdom.Item.Tuple.Height" Brush="Kingdom.Wars.AtPeace.Tuple" Command.Click="OnSelect" IsSelected="@IsSelected" DoNotPassEventsToChildren="true">
      <Children>

        <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="10" MarginRight="10">
          <Children>

            <!--Banner-->
            <MaskedTextureWidget DataSource="{Faction2Visual}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Banner.Width.Scaled" SuggestedHeight="!Banner.Height.Scaled" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Flat.Tuple.Banner.Small" AdditionalArgs="@AdditionalArgs" ImageId="@Id" TextureProviderName="@TextureProviderName" IsDisabled="true" />

            <!--Tribute Icons-->
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="40" VerticalAlignment="Center" MarginLeft="15">
              <Children>
                <!-- Receiving Tribute Icon -->
                <ValueBasedVisibilityWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="39" SuggestedHeight="42" HorizontalAlignment="Left" VerticalAlignment="Center" Sprite="SPKingdom\Diplomacy\paying_tribute" WatchType="BiggerThan" IndexToWatch="@TributePaid" IndexToBeVisible="0"/>
                <!-- Paying Tribute Icon -->
                <ValueBasedVisibilityWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="33" HorizontalAlignment="Left" VerticalAlignment="Center" Sprite="SPKingdom\Diplomacy\receiving_tribute" HorizontalFlip="true" WatchType="LessThan" IndexToWatch="@TributePaid" IndexToBeVisible="0"/>
              </Children>
            </Widget>

            <!--Name-->
            <TextWidget Id="FactionNameText" DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginRight="20" Brush="ArmyManagement.Army.Tuple.Name" IsEnabled="false" Text="@Faction2Name" />

            <!--Trade Agreement/Alliance Icons-->
            <ListPanel DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="0" VerticalAlignment="Center" MarginRight="20" StackLayout.LayoutMethod="VerticalBottomToTop">
              <Children>
                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="40" HorizontalAlignment="Center" MarginTop="-3" MarginBottom="-3" Sprite="SPKingdom\Diplomacy\diplomacy_trade_agreement_icon" IsVisible="@HasTradeAgreement"/>
                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="40" HorizontalAlignment="Center" MarginTop="-3" MarginBottom="-3" Sprite="SPKingdom\Diplomacy\diplomacy_alliance_icon" IsVisible="@HasAlliance"/>
              </Children>
            </ListPanel>
            
            <!--Truce Icon-->
            <Widget DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" VerticalAlignment="Center" HorizontalAlignment="Center" Sprite="SPKingdom\Diplomacy\diplomacy_peace_icon" IsEnabled="false"/>

          </Children>
        </ListPanel>

      </Children>
    </ButtonWidget>
  </Window>
</Prefab>