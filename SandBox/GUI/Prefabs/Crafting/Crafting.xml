<Prefab>
  <Constants>
    <Constant Name="TabControlPath" Value="..\..\..\CraftingCategoryParent\InnerPanel\PartListPanel\PartList" />

    <Constant Name="NextButton.Width" BrushLayer="Default" BrushName="ButtonBrush1" BrushValueType="Width" />
    <Constant Name="NextButton.Height" BrushLayer="Default" BrushName="ButtonBrush1" BrushValueType="Height" />

    <Constant Name="PreviousButton.Width" BrushLayer="Default" BrushName="ButtonBrush2" BrushValueType="Width" />
    <Constant Name="PreviousButton.Height" BrushLayer="Default" BrushName="ButtonBrush2" BrushValueType="Height" />

    <Constant Name="Crafting.Piece.Card.Height" Value="60" />
    <Constant Name="Crafting.Piece.Card.Width" Value="85" />

    <Constant Name="Reference.Alpha.Factor" Value="0" />
    <Constant Name="VerticalMargin.BetweenPartCards" Value="5" />

    <Constant Name="Crafting.MainAction.Button.Width" BrushLayer="Default" BrushName="Crafting.MainAction.Button" BrushValueType="Width" />
    <Constant Name="Crafting.MainAction.Button.Height" BrushLayer="Default" BrushName="Crafting.MainAction.Button" BrushValueType="Height" />
    <Constant Name="TabControlWidget.Path" Value="..\..\..\..\..\RightPanel\CraftingCategoryParent\InnerPanel\PartListParent\PartList" />
  </Constants>
  <Variables>
  </Variables>
  <VisualDefinitions>
  </VisualDefinitions>
  <Window>
    <CraftingScreenWidget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" FinalCraftButtonWidget="NewCraftedWeaponPopupWidget\CraftingResult\FinalActionButtonWidget\ButtonWidget" IsInCraftingMode="@IsInCraftingMode" IsInSmeltingMode="@IsInSmeltingMode" IsInRefinementMode="@IsInRefinementMode" MainActionButtonWidget="RightPanel\MainActionListPanel\MainActionParent\MainActionButtonWidget" NewCraftedWeaponPopupWidget="NewCraftedWeaponPopupWidget" CraftingOrderPopupWidget="CraftingOrderPopupWidget">
      <Children>

        <!--Total Yield/Cost Bottom Panel-->
        <ListPanel DataSource="{PlayerCurrentMaterials}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Bottom" MarginRight="675" MarginBottom="0">
          <ItemTemplate>

            <!--Resource Item-->
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="95" SuggestedHeight="96" VerticalAlignment="Bottom" DoNotPassEventsToChildren="true">
              <Children>

                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                  <Children>
                    <CraftingMaterialVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="55" HorizontalAlignment="Center" Brush="Crafting.Material.Brush" MaterialType="@ResourceMaterialTypeAsStr" IsBig="true"/>
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="24" VerticalAlignment="Bottom" Sprite="Crafting\number_background" Color="#EFAB6BFF" >
                      <Children>
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Refinement.Amount.Text" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="5" IntText="@ResourceAmount" />
                      </Children>
                    </Widget>
                  </Children>
                </ListPanel>

                <!--Material Count Change Widget-->
                <ChangeAmountTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" PositionYOffset="-20" Brush="Crafting.Material.Text" Amount="@ResourceChangeAmount" NegativeBrushName="Crafting.Material.NegativeChange.Text" PositiveBrushName="Crafting.Material.PositiveChange.Text" />
                <HintWidget DataSource="{ResourceHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />

              </Children>
            </Widget>

          </ItemTemplate>
        </ListPanel>

        <!--Crafting Left Side-->
        <!--Difficulty Bar-->
        <ListPanel Id="DebugDifficultyBarParent" DoNotAcceptEvents="true" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" MarginLeft="100" MarginBottom="230" IsVisible="@IsInCraftingMode" StackLayout.LayoutMethod="VerticalTopToBottom">
          <Children>

            <TextWidget DataSource="{WeaponDesign}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="100" SuggestedHeight="30" HorizontalAlignment="Left" VerticalAlignment="Bottom" MarginLeft="4" Brush="Crafting.Difficulty.Text" Brush.TextHorizontalAlignment="Center" Brush.FontSize="24" Text="@DifficultyText" />

            <Widget Id="DebugDifficultyBarParent" DataSource="{WeaponDesign}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="108" SuggestedHeight="507" HorizontalAlignment="Left" VerticalAlignment="Center">
              <Children>
                <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="Crafting\progress_bar_bed" />

                <CraftingDifficultyBarParentWidget Id="SkillBarParent" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" OrderDifficulty="@CurrentOrderDifficulty" SmithingLevel="@CurrentHeroCraftingSkill" SmithingLevelTextWidget="CurrentSkillValueBar\FillWidget\Text" OrderDifficultyTextWidget="OrderDifficultyBar\FillWidget\DifficultyText">
                  <Children>

                    <!--Dimension Sync Widget for the Top part of the difficulty-->
                    <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" StackLayout.LayoutMethod="VerticalBottomToTop" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40">
                      <Children>
                        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="crafting_difficulty_top_9"/>
                        <DimensionSyncWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" DimensionToSync="Vertical" IsEnabled="false" WidgetToCopyHeightFrom="..\..\CraftingHeroDifficultyBar\FillWidget"/>
                      </Children>
                    </ListPanel>


                    <!--Vertical Fill Bar that we use to place the skill value ring-->
                    <FillBarVerticalWidget Id="CraftingHeroDifficultyBar" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40" FillWidget="FillWidget" InitialAmount="@CurrentHeroCraftingSkill" IsDirectionUpward="true" MaxAmount="@MaxDifficulty" >
                      <Children>
                        <Widget Id="FillWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="2" HorizontalAlignment="Center" >
                          <Children>
                            <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="BlankWhiteSquare_9" Color="#00B900FF"/>
                          </Children>
                        </Widget>
                      </Children>
                    </FillBarVerticalWidget>

                    <BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40" Brush="Crafting.Difficulty.Overlay" />

                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="Crafting\progress_bar_frame" />

                    <!--Vertical Fill Bar that we use to color the difficulty bar-->
                    <FillBarVerticalWidget Id="DifficultyBar" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40" FillWidget="FillWidget" InitialAmount="@CurrentDifficulty" IsDirectionUpward="true" MaxAmount="@MaxDifficulty" >
                      <Children>
                        <Widget Id="FillWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="1" HorizontalAlignment="Center" >
                          <Children>
                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="92" SuggestedHeight="8" HorizontalAlignment="Center" VerticalAlignment="Top" Sprite="Crafting\progress_bar_indicator" />
                            <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="110" HorizontalAlignment="Right" VerticalAlignment="Top" PositionXOffset="-55" Brush="Crafting.Difficulty.Text" Brush.TextHorizontalAlignment="Right" Brush.TextVerticalAlignment="Top" Text="@CurrentDifficultyText"/>
                          </Children>
                        </Widget>
                      </Children>
                    </FillBarVerticalWidget>

                    <!--Crafting order difficulty text-->
                    <FillBarVerticalWidget Id="OrderDifficultyBar" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40" FillWidget="FillWidget" InitialAmount="@CurrentOrderDifficulty" IsDirectionUpward="true" MaxAmount="@MaxDifficulty" IsVisible="@IsInOrderMode">
                      <Children>
                        <Widget Id="FillWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="1" HorizontalAlignment="Center" >
                          <Children>
                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="92" SuggestedHeight="8" HorizontalAlignment="Center" VerticalAlignment="Top" Sprite="Crafting\progress_bar_indicator" Color="#00FFE8FF" />
                            <TextWidget Id="DifficultyText" WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="150" HorizontalAlignment="Left" VerticalAlignment="Top" PositionXOffset="45" Brush="Crafting.Difficulty.Text" Brush.TextHorizontalAlignment="Left" Brush.TextVerticalAlignment="Top" Text="@CurrentOrderDifficultyText"/>
                          </Children>
                        </Widget>
                      </Children>
                    </FillBarVerticalWidget>

                    <!--Dimension Sync Widget for the crafting skill value ring-->
                    <FillBarVerticalWidget Id="CurrentSkillValueBar" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="40" MarginRight="40" MarginBottom="40" MarginTop="40" FillWidget="FillWidget" InitialAmount="@CurrentHeroCraftingSkill" IsDirectionUpward="true" MaxAmount="@MaxDifficulty">
                      <Children>
                        <Widget Id="FillWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="1" HorizontalAlignment="Center" >
                          <Children>
                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="64" SuggestedHeight="23" VerticalAlignment="Top" HorizontalAlignment="Center" PositionYOffset="-15" Sprite="Crafting\crafting_skill_ring" IsHidden="@IsCurrentHeroAtMaxCraftingSkill" />
                            <TextWidget Id="Text" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left"  VerticalAlignment="Top" PositionXOffset="45" Brush="Crafting.Difficulty.Text" Text="@CurrentCraftingSkillValueText" />
                          </Children>
                        </Widget>
                      </Children>
                    </FillBarVerticalWidget>

                  </Children>
                </CraftingDifficultyBarParentWidget>

              </Children>
            </Widget>
          </Children>
        </ListPanel>

        <!--Right Bottom Buttons-->
        <NavigationScopeTargeter ScopeID="RightBottomButtonsScope" ScopeParent="..\RightBottomButtons" ScopeMovements="Vertical" />
        <ListPanel Id="RightBottomButtons" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginRight="675" MarginBottom="60" IsVisible="@IsInCraftingMode" StackLayout.LayoutMethod="VerticalTopToBottom" DoNotUseCustomScale="true">
          <Children>

            <!--Reset Angle Button-->
            <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="58" SuggestedHeight="69" HorizontalAlignment="Right" VerticalAlignment="Bottom" Brush="Crafting.Reset.Angle.Button" UpdateChildrenStates="true" Command.Click="ExecuteResetCamera" GamepadNavigationIndex="1">
              <Children>
                <HintWidget DataSource="{ResetCameraHint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="58" SuggestedHeight="69" HorizontalAlignment="Center" VerticalAlignment="Bottom" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
              </Children>
            </ButtonWidget>

            <!--Scabbard Toggle-->
            <ButtonWidget DataSource="{WeaponDesign}" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="58" SuggestedHeight="69" HorizontalAlignment="Right" VerticalAlignment="Bottom" Brush="Crafting.Show.Scabbard.Button" Command.Click="ExecuteChangeScabbardVisibility" IsEnabled="@CurrentWeaponHasScabbard" IsVisible="@CurrentWeaponHasScabbard" IsSelected="@IsScabbardVisible" UpdateChildrenStates="true" GamepadNavigationIndex="0">
              <Children>
                <HintWidget DataSource="{ScabbardHint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="58" SuggestedHeight="69" HorizontalAlignment="Center" VerticalAlignment="Bottom" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
              </Children>
            </ButtonWidget>
          </Children>
        </ListPanel>

        <!--Input Key List-->
        <Widget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginRight="675" MarginBottom="225" IsVisible="@AreGamepadControlHintsEnabled" DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" DoNotUseCustomScale="true">
          <Children>
            <ListPanel DataSource="{CameraControlKeys}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
              <ItemTemplate>
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="HorizontalLeftToRight">
                  <Children>
                    <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="40" VerticalAlignment="Center" Text="@KeyName" Brush="FaceGen.Property.Text" />
                    <InputKeyVisualWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="69" SuggestedHeight="69" VerticalAlignment="Center" KeyID="@KeyID" IsVisible="@IsVisible"/>
                  </Children>
                </ListPanel>
              </ItemTemplate>
            </ListPanel>
          </Children>
        </Widget>

        <!--Left Side Part Tab Selection Box-->
        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="140" SuggestedHeight="470" HorizontalAlignment="Right" VerticalAlignment="Center" PositionXOffset="-660" PositionYOffset="-147" Sprite="Crafting\left_panel_crafting" IsVisible="@IsInCraftingMode" DoNotUseCustomScaleAndChildren="true">
          <Children>
            <!--Inner Panel-->
            <Widget DataSource="{WeaponDesign}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="96" SuggestedHeight="286" MarginLeft="32" MarginTop="45">
              <Children>

                <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="10" StackLayout.LayoutMethod="VerticalBottomToTop">
                  <Children>
                    <!-- Piece Type Selections (Blade, Pommel, Guard, Handle) -->
                    <NavigationScopeTargeter ScopeID="PieceListsScope" ScopeParent="..\PieceLists" ScopeMovements="Vertical" />
                    <NavigatableListPanel Id="PieceLists" DataSource="{PieceLists}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" >
                      <ItemTemplate>
                        <CraftingPieceTypeSelectorButtonWidget VisualsWidget="CraftingPieceItemImageWidget" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="84" SuggestedHeight="59" MarginBottom="10" Command.Click="ExecuteSelect" DoNotPassEventsToChildren="true" IsSelected="@IsSelected" IsVisible="@IsEnabled" DoNotUseCustomScaleAndChildren="true">
                          <Children>
                            <CraftingPieceItemImageWidget Id="CraftingPieceItemImageWidget" DataSource="{SelectedPiece}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" PlayerHasPiece="@PlayerHasPiece" DontHavePieceBrush="Crafting.Piece.Left.Card.DontHavePiece" HasPieceBrush="Crafting.Piece.Left.Card.HasPiece" UpdateChildrenStates="true" ImageIdentifier="ImageIdentifier" DontHavePieceMaterialBrush="Crafting.Piece.MaterialBrush.DontHavePiece" HasPieceMaterialBrush="Crafting.Piece.MaterialBrush.HavePiece">
                              <Children>
                                <ImageIdentifierWidget Id="ImageIdentifier" DataSource="{ImageIdentifier}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="75" SuggestedHeight="55" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="2" AdditionalArgs="@AdditisonalArgs" ImageId="@Id" TextureProviderName="@TextureProviderName"  OverrideDefaultStateSwitchingEnabled="false"/>
                                <!-- Empty Piece Icon -->
                                <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="40" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="Crafting.Piece.Empty" ColorFactor="1.2" IsVisible="@IsEmpty"/>
                                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="20" SuggestedHeight="20" HorizontalAlignment="Left" VerticalAlignment="Bottom" MarginLeft="5" MarginBottom="5" Sprite="StdAssets\lock_closed" IsHidden="@PlayerHasPiece"/>
                                <!-- Tier Text -->
                                <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="2" MarginLeft="2" Brush="Crafting.Card.Tier.Text" Text="@TierText" />
                                <!-- Attribute Icons -->
                                <ListPanel DataSource="{ItemAttributeIcons}" WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="25" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginBottom="4" StackLayout.LayoutMethod="HorizontalRightToLeft">
                                  <ItemTemplate>
                                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="18" SuggestedHeight="18" IsVisible="@IsDisplayed" Sprite="@IconPath" />
                                  </ItemTemplate>
                                </ListPanel>
                              </Children>
                            </CraftingPieceItemImageWidget>
                            <CraftingCardHighlightBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="15" SuggestedHeight="15" VerticalAlignment="Top" HorizontalAlignment="Right" MarginTop="5" MarginRight="5" Brush="Crafting.Piece.Card.NewlyUnlocked.Dot" IsVisible="@HasNewlyUnlockedPieces"/>
                          </Children>
                        </CraftingPieceTypeSelectorButtonWidget>
                      </ItemTemplate>
                    </NavigatableListPanel>

                  </Children>
                </ListPanel>

              </Children>
            </Widget>

            <NavigationScopeTargeter ScopeID="ControlButtonsScope" ScopeParent="..\ControlButtons" ScopeMovements="Horizontal" AlternateScopeMovements="Vertical" AlternateMovementStepSize="2" />
            <Widget Id="ControlButtons" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Bottom" HorizontalAlignment="Center" MarginRight="3" DoNotAcceptEvents="true" >
              <Children>

                <!--Randomize-->
                <ButtonWidget DataSource="{WeaponDesign}" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="54" SuggestedHeight="40" HorizontalAlignment="Left" VerticalAlignment="Bottom" MarginLeft="22" MarginBottom="85" Brush="Crafting.Randomize.Button" Command.Click="ExecuteRandomize" GamepadNavigationIndex="0">
                  <Children>
                    <HintWidget DataSource="{RandomizeHint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" Sprite="General\CharacterCreation\button_random" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
                  </Children>
                </ButtonWidget>

                <!-- History -->
                <ButtonWidget DataSource="{WeaponDesign\CraftingHistory}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="54" SuggestedHeight="40" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginRight="2" MarginBottom="85" GamepadNavigationIndex="1">
                  <Children>

                    <ButtonWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" DoNotPassEventsToChildren="true" UpdateChildrenStates="true" Command.Click="ExecuteOpen" IsEnabled="@HasItemsInHistory" Brush="Crafting.History.Button">
                      <Children>
                        <ImageWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" HorizontalAlignment="Center" VerticalAlignment="Center" SuggestedWidth="48" SuggestedHeight="48" Brush="Crafting.History.Icon" />
                        <HintWidget DataSource="{HistoryHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
                      </Children>
                    </ButtonWidget>

                    <HintWidget DataSource="{HistoryDisabledHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true"/>
                  </Children>
                </ButtonWidget>

                <!--Undo-->
                <ButtonWidget DataSource="{WeaponDesign}" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="54" SuggestedHeight="40" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginRight="61" MarginBottom="35" Brush="FaceGen.Extension.Button" Command.Click="ExecuteUndo" GamepadNavigationIndex="2">
                  <Children>
                    <HintWidget DataSource="{UndoHint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" Sprite="General\CharacterCreation\button_undo" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
                  </Children>
                </ButtonWidget>

                <!--Redo-->
                <ButtonWidget DataSource="{WeaponDesign}" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="54" SuggestedHeight="40" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginRight="2" MarginBottom="35" Brush="FaceGen.Extension.Button" Command.Click="ExecuteRedo" GamepadNavigationIndex="3">
                  <Children>
                    <HintWidget DataSource="{RedoHint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="30" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" Sprite="General\CharacterCreation\button_undo" HorizontalFlip="true" VerticalFlip="true" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
                  </Children>
                </ButtonWidget>

              </Children>
            </Widget>

          </Children>
        </Widget>

        <!--Smelting Left Panel-->
        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="918" HorizontalAlignment="Left" VerticalAlignment="Center" MarginLeft="179" MarginTop="20" MarginBottom="150" IsVisible="@IsInSmeltingMode" MinHeight="287">
          <Children>
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1053" SuggestedHeight="4" HorizontalAlignment="Center" VerticalAlignment="Top" Sprite="Crafting\left_field_frame" />

            <Widget DataSource="{Smelting}" WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="1053" HorizontalAlignment="Center" MarginTop="4" Sprite="Crafting\left_field_canvas" Color="#000000FF" MinHeight="287">
              <Children>

                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" IsVisible="@IsAnyItemSelected" StackLayout.LayoutMethod="VerticalBottomToTop">
                  <Children>

                    <ListPanel DataSource="{CurrentSelectedItem}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" MarginBottom="60" MarginTop="60" StackLayout.LayoutMethod="HorizontalLeftToRight">
                      <Children>

                        <ImageIdentifierWidget DataSource="{Visual}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="224" SuggestedHeight="102" HorizontalAlignment="Center" VerticalAlignment="Center" AdditionalArgs="@AdditionalArgs" ImageId="@Id" TextureProviderName="@TextureProviderName" LoadingIconWidget="LoadingIconWidget" >
                          <Children>
                            <Standard.CircleLoadingWidget HorizontalAlignment="Center" VerticalAlignment="Center" Id="LoadingIconWidget"/>
                          </Children>
                        </ImageIdentifierWidget>

                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Text="+" Brush.FontColor="#F4E1C4FF" Brush.FontSize="48" MarginRight="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>

                        <ListPanel DataSource="{InputMaterials}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" VerticalAlignment="Center">
                          <ItemTemplate>

                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="95" SuggestedHeight="96" VerticalAlignment="Bottom" DoNotPassEventsToChildren="true">
                              <Children>

                                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                                  <Children>
                                    <CraftingMaterialVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="55" HorizontalAlignment="Center" Brush="Crafting.Material.Brush" MaterialType="@ResourceMaterialTypeAsStr" IsBig="true"/>
                                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="24" VerticalAlignment="Bottom" Sprite="Crafting\number_background" Color="#EFAB6BFF" >
                                      <Children>
                                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Refinement.Amount.Text" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="5" IntText="@ResourceAmount" />
                                      </Children>
                                    </Widget>
                                  </Children>
                                </ListPanel>

                                <!--Material Count Change Widget-->
                                <HintWidget DataSource="{ResourceHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />

                              </Children>
                            </Widget>
                          </ItemTemplate>
                        </ListPanel>

                        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="96" SuggestedHeight="29" VerticalAlignment="Center" HorizontalAligment="Center" MarginLeft="15" MarginRight="15" Sprite="Crafting\arrow" />

                        <!--Item Yield Values-->
                        <ListPanel DataSource="{Yield}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop">
                          <ItemTemplate>

                            <!--Resource Item-->
                            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="95" SuggestedHeight="96" VerticalAlignment="Bottom" DoNotPassEventsToChildren="true">
                              <Children>

                                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                                  <Children>
                                    <CraftingMaterialVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="55" HorizontalAlignment="Center" Brush="Crafting.Material.Brush" MaterialType="@ResourceMaterialTypeAsStr" IsBig="true"/>
                                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="90" SuggestedHeight="24" VerticalAlignment="Bottom" Sprite="Crafting\number_background" Color="#EFAB6BFF" >
                                      <Children>
                                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Refinement.Amount.Text" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="5" IntText="@ResourceAmount" />
                                      </Children>
                                    </Widget>
                                  </Children>
                                </ListPanel>

                                <!--Material Count Change Widget-->
                                <HintWidget DataSource="{ResourceHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />

                              </Children>
                            </Widget>

                          </ItemTemplate>
                        </ListPanel>
                      </Children>
                    </ListPanel>

                  </Children>
                </ListPanel>

              </Children>
            </Widget>

            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1053" SuggestedHeight="4" HorizontalAlignment="Center" VerticalAlignment="Bottom" Sprite="Crafting\left_field_frame" VerticalFlip="true" />

            <TextWidget IsHidden="@IsSmeltingItemSelected" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" Text="@SelectItemToSmeltText" />
          </Children>
        </Widget>

        <!--Refinement Left Panel-->
        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="918" HorizontalAlignment="Left" VerticalAlignment="Top" MarginLeft="179" MarginTop="226" MarginBottom="20" IsVisible="@IsInRefinementMode" MinHeight="287">
          <Children>
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1053" SuggestedHeight="4" HorizontalAlignment="Center" VerticalAlignment="Top" Sprite="Crafting\left_field_frame" IsEnabled="false" />

            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1053" SuggestedHeight="370" HorizontalAlignment="Center" MarginTop="4" Sprite="Crafting\left_field_canvas" Color="#000000FF">
              <Children>

                <Widget DataSource="{Refinement}" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" IsVisible="@IsValidRefinementActionSelected" HorizontalAlignment="Center">
                  <Children>

                    <ListPanel DataSource="{CurrentSelectedAction}" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center">
                      <Children>

                        <ListPanel DataSource="{InputMaterials}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center">
                          <ItemTemplate>
                            <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                              <Children>
                                <CraftingMaterialVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="181" SuggestedHeight="110" HorizontalAlignment="Center" Brush="Crafting.Material.Brush" IsBig="true" MaterialType="@ResourceMaterialTypeAsStr" />
                                <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Refinement.Amount.Text" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="5" IntText="@ResourceAmount" />
                                <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="100" HorizontalAlignment="Center" VerticalAlignment="Bottom" Brush="Refinement.Tuple.Text" Text="@ResourceName"/>
                              </Children>
                            </ListPanel>
                          </ItemTemplate>
                        </ListPanel>

                        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="96" SuggestedHeight="29" VerticalAlignment="Center" MarginLeft="15" MarginRight="15" Sprite="Crafting\arrow" />

                        <ListPanel DataSource="{OutputMaterials}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Center">
                          <ItemTemplate>
                            <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
                              <Children>
                                <CraftingMaterialVisualBrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="181" SuggestedHeight="110" HorizontalAlignment="Center" Brush="Crafting.Material.Brush" IsBig="true" MaterialType="@ResourceMaterialTypeAsStr"/>
                                <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Refinement.Amount.Text" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="5" IntText="@ResourceAmount" />
                                <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="100" HorizontalAlignment="Center" VerticalAlignment="Bottom" Brush="Refinement.Tuple.Text" Text="@ResourceName"/>
                              </Children>
                            </ListPanel>
                          </ItemTemplate>
                        </ListPanel>

                      </Children>
                    </ListPanel>
                  </Children>
                </Widget>

              </Children>
            </Widget>

            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1053" SuggestedHeight="4" HorizontalAlignment="Center" VerticalAlignment="Bottom" Sprite="Crafting\left_field_frame" VerticalFlip="true" IsEnabled="false" />

            <TextWidget IsHidden="@IsRefinementItemSelected" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" Text="@SelectItemToRefineText" />
          </Children>
        </Widget>

        <!--Category Selection-->
        <ListPanel Id="CategoryParent" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1100" SuggestedHeight="140" HorizontalAlignment="Center" VerticalAlignment="Top" MarginRight="650" MarginTop="0" StackLayout.LayoutMethod="HorizontalCentered">
          <Children>

            <ButtonWidget Id="SmeltingCategoryButton" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="380" SuggestedHeight="136"  Brush="Crafting.SmeltingTab.Button" Command.Click="ExecuteSwitchToSmelting" IsSelected="@IsInSmeltingMode" UpdateChildrenStates="true">
              <Children>

                <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" StackLayout.LayoutMethod="VerticalBottomToTop" VerticalAlignment="Center" MarginTop="7" UpdateChildrenStates="true" IsHidden="@IsInSmeltingMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="33" SuggestedHeight="29" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Smelt.Icon" />
                    <TextWidget  WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="60" Brush="Crafting.Tabs.Text" Text="@SmeltingText"/>
                  </Children>
                </ListPanel>

                <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" StackLayout.LayoutMethod="VerticalBottomToTop" VerticalAlignment="Center" MarginTop="7" UpdateChildrenStates="true" IsVisible="@IsInSmeltingMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Smelt.Icon" />
                    <TextWidget  WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="45" Brush="Crafting.Tabs.Text.Large" Text="@SmeltingText"/>
                  </Children>
                </ListPanel>

                <Widget DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="60" SuggestedHeight="60" HorizontalAlignment="Left" VerticalAlignment="Center" IsVisible="@CanSwitchTabs">
                  <Children>
                    <InputKeyVisualWidget DataSource="{PreviousTabInputKey}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" KeyID="@KeyID" IsVisible="@IsVisible"/>
                  </Children>
                </Widget>
              </Children>
            </ButtonWidget>

            <ButtonWidget Id="CraftingCategoryButton" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="380" SuggestedHeight="136" Brush="Crafting.CraftingTab.Button" Command.Click="ExecuteSwitchToCrafting" IsSelected="@IsInCraftingMode" UpdateChildrenStates="true">
              <Children>

                <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="7" StackLayout.LayoutMethod="VerticalBottomToTop" UpdateChildrenStates="true" IsHidden="@IsInCraftingMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="33" SuggestedHeight="29" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Craft.Icon" />
                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="60" Brush="Crafting.Tabs.Text" Text="@CraftingText" />
                  </Children>
                </ListPanel>

                <ListPanel DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="7" StackLayout.LayoutMethod="VerticalBottomToTop" UpdateChildrenStates="true" IsVisible="@IsInCraftingMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Craft.Icon" />
                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="45" Brush="Crafting.Tabs.Text.Large" Text="@CraftingText" />
                  </Children>
                </ListPanel>

              </Children>
            </ButtonWidget>

            <ButtonWidget Id="RefinementCategoryButton" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="380" SuggestedHeight="136"  Brush="Crafting.RefinementTab.Button" Command.Click="ExecuteSwitchToRefinement" IsSelected="@IsInRefinementMode" UpdateChildrenStates="true" ClipContents="false" >
              <Children>

                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop" MarginTop="7" UpdateChildrenStates="true" IsHidden="@IsInRefinementMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="33" SuggestedHeight="29" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Refine.Icon" />
                    <TextWidget  WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="60" Brush="Crafting.Tabs.Text" Text="@RefinementText"/>
                  </Children>
                </ListPanel>

                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop" MarginTop="7" UpdateChildrenStates="true" IsVisible="@IsInRefinementMode">
                  <Children>
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="40" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Refine.Icon" />
                    <TextWidget  WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="100" MarginRight="100" MarginBottom="45" Brush="Crafting.Tabs.Text.Large" Text="@RefinementText"/>
                  </Children>
                </ListPanel>

                <Widget DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="60" SuggestedHeight="60" HorizontalAlignment="Right" VerticalAlignment="Center" IsVisible="@CanSwitchTabs">
                  <Children>
                    <InputKeyVisualWidget DataSource="{NextTabInputKey}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" KeyID="@KeyID" IsVisible="@IsVisible"/>
                  </Children>
                </Widget>

              </Children>
            </ButtonWidget>

          </Children>
        </ListPanel>

        <!--Character Switch-->
        <NavigationScopeTargeter ScopeID="CharacterSelectionScope" ScopeParent="..\CharacterSelection" ScopeMovements="Horizontal"/>
        <ListPanel Id="CharacterSelection" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" MarginBottom="120" MarginLeft="60" VerticalAlignment="Bottom">
          <Children>
            <ButtonWidget Id="CurrentCraftingHeroToggleWidget" DataSource="{CurrentCraftingHero}" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="130" SuggestedHeight="96" UpdateChildrenStates="true" GamepadNavigationIndex="0" Command.Click="..\CraftingHeroPopup\ExecuteOpenPopup" >
              <Children>
                <BrushWidget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Crafting.Order.Card" />
                <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" VerticalAlignment="Bottom" MarginRight="2" MarginLeft="2" MarginBottom="2" Sprite="scrollable_field_gradient_9"/>
                <ImageIdentifierWidget DataSource="{HeroData\ImageIdentifier}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="100" SuggestedHeight="70" HorizontalAlignment="Center" VerticalAlignment="Bottom" PositionYOffset="-2" AdditionalArgs="@AdditionalArgs" ImageId="@Id" TextureProviderName="@TextureProviderName" IsDisabled="true" OverrideDefaultStateSwitchingEnabled="false"/>
                <TextWidget DataSource="{HeroData}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Top" PositionYOffset="100" Brush="TownManagement.GovernorPopup.Name.Text" Brush.FontSize="14" Text="@NameText" />
                <HintWidget DataSource="{Hint}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />

                <!--Stamina-->
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Top" HorizontalAlignment="Right" MarginTop="6" MarginRight="6" StackLayout.LayoutMethod="VerticalTopToBottom">
                  <Children>
                    <!--Stamina Bar-->
                    <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="8" SuggestedHeight="50" MarginTop="5" HorizontalAlignment="Center" Brush="TownManagement.GovernorPopup.GoldFrame">
                      <Children>
                        <FillBarVerticalClipTierColorsWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MaxAmount="@MaxStamina" InitialAmountAsFloat="@CurrentStamina" FillWidget="FillWidget" IsDirectionUpward="true" Sprite="BlankWhiteSquare_9" Color="#000000DD" MaxedColor="#08BF14FF" HighColor="#80AB22FF" MediumColor="#C75808FF" LowColor="#AD0303FF" HorizontalAlignment="Center">
                          <Children>
                            <Widget Id="FillWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" Sprite="BlankWhiteSquare_9" Color="#348220FF"/>
                          </Children>
                        </FillBarVerticalClipTierColorsWidget>
                      </Children>
                    </BrushWidget>

                    <!--Stamina Text-->
                    <TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="30" SuggestedHeight="10" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="Crafting.Stamina.Percentage.Text" Text="@StaminaPercentage" />
                  </Children>
                </ListPanel>

                <!-- Skill Level -->
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Top" HorizontalAlignment="Left" MarginTop="6" MarginLeft="6" StackLayout.LayoutMethod="HorizontalLeftToRight" DoNotAcceptEvents="true">
                  <Children>
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="20" SuggestedHeight="14" Sprite="General\Icons\ShopIcons\smithy_large" />
                    <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" Brush="Crafting.Stamina.Percentage.Text" IntText="@SmithySkillLevel" />
                  </Children>
                </ListPanel>

              </Children>
            </ButtonWidget>

          </Children>
        </ListPanel>

        <!--Right Panel-->
        <Widget Id="RightPanel" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="694" SuggestedHeight="1080" HorizontalAlignment="Right" Sprite="Crafting\right_panel_crafting" VerticalAlignment="Center" DoNotUseCustomScaleAndChildren="true" DoNotAcceptEvents="true">
          <Children>

            <Widget Id="RightPanelBackground" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="650" SuggestedHeight="1080" HorizontalAlignment="Right" VerticalAlignment="Center"/>

            <!--Crafted Item Name Box-->
            <!--TextWidget WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="670" HorizontalAlignment="Right" Brush="Stage.Title.Text" Text="@CurrentCategoryText" ClipContents="false" MarginTop="5"/-->

            <!--Inner Panel Categories-->
            <!--Crafting Category-->
            <CraftingCategory Id="CraftingCategoryParent" IsVisible="@IsInCraftingMode" />

            <!--Smelting Category-->
            <Widget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@IsInSmeltingMode">
              <Children>
                <SmeltingCategory Id="SmeltingCategoryParent" DataSource="{Smelting}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" />
              </Children>
            </Widget>

            <!--Refinement Category-->
            <Widget DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@IsInRefinementMode">
              <Children>
                <RefinementCategory Id="RefinementCategoryParent" DataSource="{Refinement}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" />
              </Children>
            </Widget>

            <TextWidget DataSource="{WeaponDesign}" Brush="Crafting.Order.WrongDamageType.Text" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="500" SuggestedHeight="50" HorizontalAlignment="Center" VerticalAlignment="Bottom" MarginBottom="65" Text="@MissingPropertyWarningText" />

            <ListPanel Id="MainActionListPanel" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" VerticalAlignment="Bottom" StackLayout.LayoutMethod="HorizontalLeftToRight">
              <Children>

                <!--Main Action Button-->
                <Widget Id="MainActionParent" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="355" SuggestedHeight="50" HorizontalAlignment="Center" VerticalAlignment="Bottom">
                  <Children>

                    <ButtonWidget Id="MainActionButtonWidget" DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Crafting.MainAction.Button" Command.Click="ExecuteMainAction" IsEnabled="@IsMainActionEnabled" UpdateChildrenStates="true">
                      <Children>
                        <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="15" Brush="Crafting.MainAction.Text" Text="@MainActionText">
                          <Children>
                            <Widget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" PositionXOffset="-40" IsVisible="@IsMainActionEnabled">
                              <Children>
                                <InputKeyVisualWidget DataSource="{ConfirmInputKey}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" KeyID="@KeyID" IsVisible="@IsVisible"/>
                              </Children>
                            </Widget>
                          </Children>
                        </TextWidget>
                      </Children>
                    </ButtonWidget>

                    <HintWidget DataSource="{MainActionHint}" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" IsDisabled="true" />

                    <Widget DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="365" SuggestedHeight="60" HorizontalAlignment="Right" VerticalAlignment="Bottom" PositionXOffset="8" Sprite="Crafting\bottom_crafting" />

                  </Children>
                </Widget>

                <!--Cancel Button-->
                <ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="136" SuggestedHeight="69" HorizontalAlignment="Right" VerticalAlignment="Bottom" MarginLeft="10" Brush="Crafting.Leave.Button" Command.Click="ExecuteCancel">
                  <Children>
                    <InputKeyVisualWidget DataSource="{ExitInputKey}" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="45" SuggestedHeight="45" HorizontalAlignment="Left" VerticalAlignment="Center" PositionYOffset="15" PositionXOffset="35" KeyID="@KeyID" IsVisible="@IsVisible"/>
                    <!--<TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="35" MarginLeft="60" Brush="CharacterDeveloper.PerkPopup.ButtonText" Text="@CancelLbl" />-->
                  </Children>
                </ButtonWidget>

              </Children>
            </ListPanel>

          </Children>
        </Widget>

        <!-- Weapon Entity Navigation -->
        <NavigationScopeTargeter ScopeID="CraftingWeaponEntityScope" ScopeParent="..\WeaponEntityTargeter" />
        <Widget Id="WeaponEntityTargeter" DataSource="{WeaponDesign}" DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="50" SuggestedHeight="50" VerticalAlignment="Center" HorizontalAlignment="Center" PositionXOffset="-280" GamepadNavigationIndex="0" />

        <!--New Crafted Weapon Popup-->
        <NewCraftedWeaponPopup Id="NewCraftedWeaponPopupWidget" DataSource="{WeaponDesign}" IsVisible="@IsInFinalCraftingStage" />
        <CraftingOrderPopup Id="CraftingOrderPopupWidget" DataSource="{WeaponDesign\CraftingOrderPopup}" IsVisible="@IsVisible" />
        <CraftingTemplateSelectionPopup Id="WeaponClassSelectionPopup" DataSource="{WeaponDesign\WeaponClassSelectionPopup}" IsVisible="@IsVisible" />
        <CraftingHistoryPopup Id="CraftingHistoryPopup" DataSource="{WeaponDesign\CraftingHistory}" IsVisible="@IsVisible" />
        <CraftingHeroPopup Id="CraftingHeroPopup" DataSource="{CraftingHeroPopup}" IsVisible="@IsVisible" />

        <!--Tutorial Notification Frame-->
        <ElementNotificationWidget DataSource="{TutorialNotification}" ElementID="@ElementID" TutorialFrameWidget="TutorialFrameWidget">
          <Children>
            <TutorialHighlightItemBrushWidget Id="TutorialFrameWidget" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="TutorialHighlightBrush" IsDisabled="true" IsVisible="false" />
          </Children>
        </ElementNotificationWidget>

      </Children>
    </CraftingScreenWidget>
  </Window>
</Prefab>